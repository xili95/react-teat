'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _cookies = require('./cookies');

var _cookies2 = _interopRequireDefault(_cookies);

var _localStore = require('./localStore');

var _localStore2 = _interopRequireDefault(_localStore);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = {
    get: function get(url, async) {
        var xmlhttp = void 0,
            token = _cookies2.default.getCookie("token");
        if (window.XMLHttpRequest) {
            xmlhttp = new XMLHttpRequest();
        } else {
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function () {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                console.log("--------请求登录人信息---------gfy_test");
                console.log(xmlhttp.responseText);

                var permission = eval('(' + xmlhttp.responseText + ')'),
                    loginUser = permission.errorCode == 0 ?
                        permission.data :
                    { "userId": null, "userImage": "", "sex": "F", "positionName": "", "userName": "" };

                _localStore2.default.setItem("permission", JSON.stringify(loginUser));
            } else {
                _localStore2.default.setItem("permission", JSON.stringify({ "userId": null, "userImage": "", "sex": "F", "positionName": "", "userName": "" }));
            }
        };
        xmlhttp.open("GET", '/attcenter/' + url, async);
        xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        xmlhttp.setRequestHeader("Authorization", "Bearer " + token);
        xmlhttp.send();
    }
};